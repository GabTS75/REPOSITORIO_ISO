# Sistema de archivos

- Comandos para gestionar discos en Ubuntu

```Bash
# Ver si se ha conectado el disco virtual
dmesg | grep "sdb"
sudo fdisk -l /dev/sdb
# Dar formato a la partición
sudo mkfs.ext4 /dev/sdb1
# Mostrar información sobre los dispositivos (¿aparece el disco sdb1?)
sudo blkid
# Crear una carpeta para montar una partición
sudo mkdir mountname
# Montar una partición en una carpeta
sudo mount -t auto -v /dev/sdb1 /mnt/mountname
# Eliminar un punto de montaje
sudo umount /dev/sdb
```

- El primer sector de la primera partición suele ser el 2048 porque las herramientas modernas como fdisk intentan alinear las particiones a 1 MiB (se reserva solo esa cantidad) para que el disco trabaje de forma más eficiente: si cada sector es de 512 bytes, entonces 1 MiB = 1 048 576 bytes, y 1 048 576 / 512 = 2048 sectores; empezar en ese sector hace que la partición quede alineada con los bloques físicos internos de discos modernos (SSD, RAID…), evitando accesos “descuadrados” y mejorando el rendimiento.
- En una VM de Linux con un disco duro virtual, utiliza fdisk o gparted para crear dos particiones. Usa pvcreate para convertirlas en volúmenes físicos. Luego, usa vgcreate para crear un grupo de volúmenes con esas dos particiones. Finalmente, usa lvcreate para crear un volumen lógico que ocupe todo el espacio del grupo.

```Bash

┌───────────────────────────────────────────────┐
│            Volúmenes Lógicos (LV)             │  ← Se montan y usan directamente
│   /dev/vg_data/lv_home   /dev/vg_data/lv_var  │
└───────────────────────────────────────────────┘
                 ↑
┌───────────────────────────────────────────────┐
│           Grupo de Volúmenes (VG)             │  ← Espacio combinado de varios PV
│                 vg_data                       │
└───────────────────────────────────────────────┘
                 ↑
┌───────────────────────────────────────────────┐
│            Volúmenes Físicos (PV)             │  ← Discos o particiones reales
│          /dev/sdc1         /dev/sdc2          │
└───────────────────────────────────────────────┘

Los PV son los discos reales.
El VG es un “pool” de espacio.
Los LV son las “pseudo-particiones” flexibles que el sistema monta y usa.
```

## Creación y montaje de un volumen lógico LVM con dos discos en Linux

```Bash
dmesg
# 1) Ver los discos conectados
lsblk

# 2) (Opcional) Borrar firmas antiguas — ¡borra todo!
sudo wipefs -a /dev/sdc
sudo wipefs -a /dev/sdd

# 3) Crear volúmenes físicos (PV)
sudo pvcreate /dev/sdc /dev/sdd

# 4) Crear grupo de volúmenes (VG)
sudo vgcreate vg_data /dev/sdc /dev/sdd

# 5) Crear volumen lógico (LV) que use todo el espacio disponible
sudo lvcreate -n lv_data -l 100%FREE vg_data

# 6) Formatear el volumen lógico con ext4
sudo mkfs.ext4 /dev/vg_data/lv_data

# 7) Crear punto de montaje y montar
sudo mkdir -p /mnt/nuevo_volumen
sudo mount /dev/vg_data/lv_data /mnt/nuevo_volumen

# 8) Verificar
lsblk
df -h /mnt/nuevo_volumen

# 9) (Opcional) Mostrar información LVM
sudo pvdisplay
sudo vgdisplay
sudo lvdisplay
```
